The terror attack in Nairobi was a tragedy. But also, to some extent, unexpected. Kenya suffered relatively frequent attacks between 2013 and 2016 – Westgate in 2013, the Mpeketoni attack and the Gikomba attack in 2014, the Garissa university attack in 2016. Since then there’s been a break in larger attacks. And since the earlier Gikomba attack, Nairobi has been spared, and Kenyan authorities have scored some successes in dismantling al-Shabaab networks in the country. They also thwarted a larger operation in Nairobi last year. Kenya has done a great deal to prevent attacks, and to manage post-attack scenarios better. Its successes so far include: improved coordination, dismantling local radical networks in contact with the al-Shabaab and curtailing channels for foreign recruitment. There have been two other areas of progress that has been, for the most part, spearheaded by civil society. The first is the implementation of deradicalisation programmes. These aim to integrate former al-Shabaab fighters into society. The second has been efforts at countering violent extremism by introducing programmes designed to prevent young people from being radicalised. But there are still huge problems that need to be addressed. One is the fact that young Muslims have very low trust in the Kenyan police, and many remain sympathetic to al-Shabaab. These problems are hard to address because of high levels of joblessness among young people which has created fertile recruiting grounds for al-Shabaab. Although Kenya has made considerable progress this week’s attack shows that al-Shabaab is still strong, viable and able to take advantage of Kenyan weaknesses.